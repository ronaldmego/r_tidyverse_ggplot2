"0","wt_mean <- function(x,w,na.rm=TRUE){"
"0","  stopifnot(is.logical(na.rm),"
"0","            length(na.rm)==1,"
"0","            length(x)==length(w)"
"0","  )"
"0","if(na.rm){"
"0","  missing <- is.na(x) | is.na(w)"
"0","  x <- x[!missing]"
"0","  w <- w[!missing]"
"0","  }"
"0","  sum(x*w)/sum(w)"
"0","  }"
